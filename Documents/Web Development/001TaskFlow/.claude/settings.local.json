{
  "permissions": {
    "allow": [
      "WebFetch(domain:github.com)",
      "Bash(npm install cookie-parser)",
      "Bash(git remote set-url:*)",
      "Bash(git add:*)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nFix critical security vulnerabilities and implement comprehensive security hardening\n\nThis commit addresses all critical and medium-severity security issues identified in the\nsecurity audit and implements defense-in-depth security measures across the application.\n\nCritical fixes:\n- Remove hardcoded JWT secrets and database passwords with mandatory environment variable validation\n- Eliminate demo credential exposure in logs and seed scripts\n- Implement strict Content Security Policy without unsafe-inline or unsafe-eval\n- Add request size limits \\(100kb\\) to prevent DoS attacks via large payloads\n\nMedium-severity fixes:\n- Implement httpOnly cookie-based authentication replacing client-side token storage\n- Add comprehensive CSRF protection with token validation for all state-changing operations\n- Fix token blacklist memory leak with expiration tracking and periodic cleanup\n- Sanitize sensitive data \\(passwords, tokens, secrets\\) in all security logs\n- Standardize password validation requiring 8+ characters with complexity requirements\n\nSecurity enhancements:\n- Add cookie-parser middleware for secure session management\n- Implement logout endpoint with token blacklisting\n- Add environment variable validation on server startup\n- Update documentation with security best practices and setup instructions\n- Add comprehensive security section to README documenting all protections\n\nBackend changes:\n- config/index.js: Environment variable validation\n- middleware/security.js: CSRF protection, CSP hardening, log sanitization\n- middleware/auth.js: httpOnly cookie support, improved token blacklist\n- controllers/authController.js: Cookie-based auth, logout endpoint\n- routes/authRoutes.js: Standardized validation, logout route\n- app.js: CSRF middleware, cookie parser, request size limits\n- database/seed.js: Configurable demo password, removed credential logging\n\nFrontend changes:\n- contexts/AuthContext.jsx: httpOnly cookie authentication flow\n- api/auth.js: Logout API integration\n- api/axios.js: CSRF token from cookies, removed manual token handling\n\n Generated with [Claude Code]\\(https://claude.com/claude-code\\)\n\nCo-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nFix failing unit tests after security updates\n\n- Fix auth.test.js mock hoisting issue with jsonwebtoken\n- Update taskController.test.js to match new response formats\n- Add missing mock for tasksByStatus.dec in metrics\n- Fix parameter type expectations \\(string vs number\\)\n- Add missing mocks for findByIdAndUserId calls in update/delete tests\n- Update getStatistics test to match actual response format\n\nAll tests now pass.\n\n Generated with [Claude Code]\\(https://claude.com/claude-code\\)\n\nCo-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git push:*)",
      "Bash(npm test:*)",
      "Bash(npm install:*)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nFix failing unit tests after security updates\n\n- Fix auth.test.js mock hoisting issue with jsonwebtoken\n- Update taskController.test.js to match new response formats\n- Add missing mock for tasksByStatus.dec in metrics\n- Fix parameter type expectations \\(string vs number\\)\n- Add missing mocks for findByIdAndUserId calls in update/delete tests\n- Update getStatistics test to match actual response format\n- Add cookie/clearCookie mocks to authController tests\n- Update auth response assertions \\(no token in response body\\)\n- Add cross-env for Windows compatibility\n- Add test environment fallbacks in config \\(skip env var validation\\)\n\nAll unit tests now pass \\(authController, taskController, auth middleware\\).\nIntegration tests require PostgreSQL database setup.\n\n Generated with [Claude Code]\\(https://claude.com/claude-code\\)\n\nCo-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(dir:*)",
      "Bash(npm run migrate:up:*)",
      "Bash(findstr:*)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nFix GitHub Actions database setup for integration tests\n\nUpdated CI/CD workflow to properly run database migrations and tests:\n\nWorkflow improvements:\n- Replace psql direct schema load with npm run migrate:up\n- Add DATABASE_URL environment variable for migrations and tests\n- Use postgresql connection string format for better compatibility\n- Maintain individual DB_* variables for backward compatibility\n\nMigration script updates:\n- Configure node-pg-migrate to use ../database/migrations directory\n- Update migrate:up, migrate:down, and migrate:create commands\n- Ensure migrations run from correct path in CI environment\n\nThis fixes integration test failures in GitHub Actions by ensuring:\n1. Database schema is properly created via migrations\n2. Connection string is available for node-pg-migrate\n3. Test environment can connect to PostgreSQL service\n\n Generated with [Claude Code]\\(https://claude.com/claude-code\\)\n\nCo-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(gh auth:*)",
      "Bash(git commit:*)",
      "Bash(docker build:*)",
      "Bash(npm audit)",
      "Bash(npm ls:*)",
      "Bash(npm audit:*)",
      "Bash(npm outdated:*)",
      "Bash(npm update:*)",
      "Bash(cat:*)",
      "Bash(git fetch:*)",
      "Bash(git hash-object:*)",
      "Bash(git ls-tree:*)",
      "Bash(git config:*)",
      "Bash(FILTER_BRANCH_SQUELCH_WARNING=1 git filter-branch:*)",
      "Bash(export FILTER_BRANCH_SQUELCH_WARNING=1)",
      "Bash(bash:*)",
      "Bash(git rm:*)"
    ]
  }
}
